
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Exercicis de tot el tema amb els resultats - BD - Bases de Datos</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exercicis-de-tot-el-tema-amb-els-resultats" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BD - Bases de Datos" class="md-header__button md-logo" aria-label="BD - Bases de Datos" data-md-component="logo">
      
  <img src="../../assets/logocaminas.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BD - Bases de Datos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Exercicis de tot el tema amb els resultats
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BD - Bases de Datos" class="md-nav__button md-logo" aria-label="BD - Bases de Datos" data-md-component="logo">
      
  <img src="../../assets/logocaminas.png" alt="logo">

    </a>
    BD - Bases de Datos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Tema 1-Introducció
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Tema 1-Introducció
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T01_Introduccio/objectius/" class="md-nav__link">
        Objectius
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T01_Introduccio/1_fitxers_tradicionals/" class="md-nav__link">
        1. Fitxers tradicionals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T01_Introduccio/2_concepte_de_base_de_dades/" class="md-nav__link">
        2. Concepte de Base de Dades
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T01_Introduccio/3_caracterstiques_desitjables_dun_sgbd/" class="md-nav__link">
        3. Característiques desitjables d'un SGBD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T01_Introduccio/4_models_de_dades/" class="md-nav__link">
        4. Models de dades
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T01_Introduccio/5_arquitectura_a_3_nivells/" class="md-nav__link">
        5. Arquitectura a 3 nivells
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T01_Introduccio/6_llenguatges_del_sgbd/" class="md-nav__link">
        6. Llenguatges del SGBD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T01_Introduccio/7_classificacions_dels_sgbd/" class="md-nav__link">
        7. Classificacions dels SGBD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T01_Introduccio/autoavaluaci/" class="md-nav__link">
        Autoavaluació
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T02_Model_E-R/" class="md-nav__link">
        Tema 2-Model E/R
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T03_Model_Relacional/" class="md-nav__link">
        Tema 3- Model Relacional
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T04_Normalitzacio/" class="md-nav__link">
        Tema 4- Normalització
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T05_Annex_Base/" class="md-nav__link">
        Tema 5- Annex Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T05_Annex_Access/" class="md-nav__link">
        Tema 5- Annex Access
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Tema 6- SQL I
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../BD-T06_SQL_II_PostgreSQL/" class="md-nav__link">
        Tema 6- SQL II]
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../(BD-T06_SQL_III_PostgreSQL/index.md" class="md-nav__link">
        Tema 6- SQL III
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../(BD-T07_PLpgSQL/index.md" class="md-nav__link">
        Tema 7- PLpgSQL
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../(BD-T08_BD_NoSQL/index.md)" class="md-nav__link">
        Tema 8- BD NoSQL
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p>Bases de Dades</p>
<ul>
<li><a href="../">Tema 6: SQL - Consulta bàsica (part I)</a></li>
<li><a href="../objectius_i_coneixements_previs/">Objectius i Coneixements previs</a></li>
<li><a href="../1_introducci/">1. Introducció</a></li>
<li><a href="../2_ddl_i_dml/">2. DDL i DML</a></li>
<li><a href="../3_client_dbeaver_installaci_i_confiuraci/">3. Client DBeaver: instal·lació i confiuració</a></li>
<li><a href="../4_client_dbeaver_utilitzaci/">4. Client DBeaver: utilització</a></li>
<li><a href="../5_dades_dels_exemples_i_els_exercicis/">5. Dades dels exemples i els exercicis</a></li>
<li><a href="../6_operadors/">6. Operadors</a></li>
<li><a href="../7_funcions/">7. Funcions</a> </li>
<li><a href="../71_formats_de_les_dates/">7.1 Formats de les dates</a></li>
<li><a href="../72_formats_dels_nmeros/">7.2 Formats dels números</a></li>
<li><a href="../8_la_consulta_select/">8. La consulta SELECT</a></li>
<li><a href="../9_consulta_bsica/">9. Consulta bàsica</a> </li>
<li><a href="../exercicis/">Exercicis</a></li>
<li><a href="../10_lies_en_les_columnes/">10. Àlies en les columnes</a> </li>
<li><a href="../exercicis0/">Exercicis</a></li>
<li><a href="../11_la_clusula_where/">11. La clàusula WHERE</a> </li>
<li><a href="../exercicis1/">Exercicis</a></li>
<li><a href="../12_funcions_dagregat/">12. Funcions d'agregat</a> </li>
<li><a href="../exercicis2/">Exercicis</a></li>
<li><a href="../13_la_clusula_group_by/">13. La clàusula GROUP BY</a> </li>
<li><a href="../exercicis3/">Exercicis</a></li>
<li><a href="../14_la_clusula_having/">14. La clàusula HAVING</a> </li>
<li><a href="../exercicis4/">Exercicis</a></li>
<li><a href="../15_la_clusula_order_by/">15. La clàusula ORDER BY</a> </li>
<li><a href="../exercicis5/">Exercicis</a></li>
<li><a href="../16_el_predicat_distinct/">16. El predicat DISTINCT</a> </li>
<li><a href="../exercicis6/">Exercicis</a></li>
<li><a href="../17_la_clusula_limit__offset/">17. La clàusula LIMIT .. OFFSET</a> </li>
<li><a href="../exercicis7/">Exercicis</a></li>
<li><a href="../18_consulta_de_creaci_de_taules/">18. Consulta de creació de taules</a> </li>
<li><a href="../exercicis8/">Exercicis</a></li>
<li><a href="../19_ordre_amb_qu_sexecuta_una_sentncia_sql/">19. Ordre amb què s'executa una sentència SQL</a></li>
<li><a href="./">Exercicis de tot el tema, amb els resultats</a></li>
</ul>
<p><a href="../19_ordre_amb_qu_sexecuta_una_sentncia_sql/">« Anterior</a></p>
<h1 id="exercicis-de-tot-el-tema-amb-els-resultats"><a name="main"></a><strong>Exercicis de tot el tema, amb els resultats</strong></h1>
<p>En la BD <strong>factura</strong>, connectant com a usuari <strong>factura</strong>:</p>
<p><strong>6.1</strong> Traure tota la informació dels pobles (anomeneu-la <strong>Ex_6_1.sql</strong>).</p>
<p><img alt="ref1" src="exercicis_de_tot_el_tema_amb_els_resultats.002.png" /></p>
<p>Un total de <strong>1663 files</strong></p>
<p><strong>6.2</strong> Traure el codi postal, el nom i l'adreça, per aquest ordre, de tots els venedors (anomeneu-la <strong>Ex_6_2.sql</strong>).</p>
<p><img alt="ref2" src="exercicis_de_tot_el_tema_amb_els_resultats.003.png" /></p>
<p><strong>6.3</strong> Traure el codi d'article, la descripció, preu i preu incrementat en un 5%, de tots els articles.</p>
<p><img alt="ref3" src="exercicis_de_tot_el_tema_amb_els_resultats.004.png" /></p>
<p>Un total de <strong>812 files</strong></p>
<p><strong>6.4</strong> Traure la informació dels clients amb el següent format (ha d'anar tot en una columna):</p>
<p><strong>Damborenea Corbato, Alicia. CALLE MADRID, 83 (12425)</strong></p>
<p>Fixeu-vos que està tot en una columna, i per tant haureu de concatenar de la forma adequada. Fixeu-vos també que en en el nom només les inicials estan en majúscules</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p>Un total de <strong>49 files</strong></p>
<p><strong>6.5</strong> Traure el num_f, data i cod_ven de les factures amb les següents capçaleres respectivament: <strong>Número Factura</strong>, <strong>data</strong> i <strong>Codi Venedor</strong> (anomeneu-lo <strong>Ex_6_5</strong>)</p>
<p><img alt="ref5" src="exercicis_de_tot_el_tema_amb_els_resultats.006.png" /></p>
<p>Un total de <strong>105 files</strong></p>
<p><strong>6.6</strong> Donar àlias als camps que ho necessiten de la taula ARTICLE (anomeneu-lo <strong>Ex_6_6</strong>)</p>
<p><img alt="ref6" src="exercicis_de_tot_el_tema_amb_els_resultats.007.png" /></p>
<p>Un total de <strong>812 files</strong></p>
<p><strong>6.7</strong> Traure els <strong>clients</strong> de la <strong>ciutat</strong> amb codi <strong>12309</strong>.</p>
<p><img alt="ref7" src="exercicis_de_tot_el_tema_amb_els_resultats.008.png" /></p>
<p><strong>6.8</strong> Traure totes les <strong>factures</strong> del mes de <strong>març</strong> de <strong>2015</strong>.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.9</strong> Traure tots els articles de la <strong>categoria</strong> <strong>BjcOlimpia</strong> amb un <strong>stock</strong> entre <strong>2</strong> i <strong>7</strong> unitats.</p>
<p><img alt="ref8" src="exercicis_de_tot_el_tema_amb_els_resultats.009.png" /></p>
<p><strong>6.10</strong> Traure tots els <strong>clients</strong> que <strong>no</strong> tenen introduït el <strong>codi postal</strong>.</p>
<p><img alt="ref9" src="exercicis_de_tot_el_tema_amb_els_resultats.010.png" /></p>
<p><strong>6.11</strong> Traure tots els <strong>articles</strong> amb el <strong>stock</strong> introduït però que <strong>no</strong> tenen introduït el <strong>stock mínim</strong>.</p>
<p><img alt="ref10" src="exercicis_de_tot_el_tema_amb_els_resultats.011.png" /></p>
<p><strong>6.12</strong> Traure tots els <strong>clients</strong>, el <strong>primer cognom</strong> dels quals és <strong>VILLALONGA</strong>.</p>
<p><img alt="ref11" src="exercicis_de_tot_el_tema_amb_els_resultats.012.png" /></p>
<p><strong>6.13.a</strong> Modificar l'anterior per a traure tots els que són <strong>VILLALONGA</strong> de <strong>primer</strong> o de <strong>segon</strong> cognom.</p>
<p><img alt="ref12" src="exercicis_de_tot_el_tema_amb_els_resultats.013.png" /></p>
<p><strong>6.13.b</strong> Modificar l'anterior per a traure tots els que <strong>no</strong> són <strong>VILLALONGA</strong> ni de primer ni de segon cognom.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p>Un total de <strong>46 files</strong></p>
<p><strong>6.14</strong> Traure els <strong>articles</strong> "<strong>Pulsador</strong>" (la descripció conté aquesta paraula), el <strong>preu</strong> dels quals oscila entre <strong>2 i 4 €</strong> i dels quals tenim un <strong>stock</strong> estrictament <strong>major</strong> que el <strong>stock mínim</strong>.</p>
<p><img alt="ref13" src="exercicis_de_tot_el_tema_amb_els_resultats.014.png" /></p>
<p><strong>6.15</strong> Comptar el nombre de <strong>clients</strong> que tenen el <strong>codi postal nul</strong>.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.16</strong> Comptar el número de vegades que l'article <strong>L76104</strong> entra en les línies de factura, i el número total d'unitats venudes d'aquest article. Només us fa falta la taula LINIA_FAC.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.17</strong> Traure la <strong>mitjana</strong> del <strong>stock</strong> dels articles.</p>
<p><img alt="ref14" src="exercicis_de_tot_el_tema_amb_els_resultats.015.png" /></p>
<p><strong>6.18</strong> Modificar l'anterior per a <strong>tenir en compte els valors nuls, com si foren 0</strong>. Us vindrà bé la funció <strong>COALESCE</strong> que converteix els nuls del primer paràmetre al valor donat com a segon paràmetre (si és diferent de nul, deixa igual el valor). Per tant l'heu d'utilitzar d'aquesta manera: <strong>COALESCE(stock,0)</strong></p>
<p><img alt="ref15" src="exercicis_de_tot_el_tema_amb_els_resultats.016.png" /></p>
<p><strong>6.19</strong> Comptar <strong>quantes factures</strong> té el client <strong>375</strong></p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.20</strong> Calcular el <strong>descompte màxim</strong>, el <strong>mínim</strong> i el descompte <strong>mitjà</strong> de les <strong>factures</strong>.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.21</strong> Comptar el número de pobles de cada província (és suficient traure el codi de la província i el número de pobles).</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.22</strong> Comptar el nombre de clients en cada poble i codi postal.</p>
<p><img alt="ref16" src="exercicis_de_tot_el_tema_amb_els_resultats.017.png" /></p>
<p>Un total de <strong>45 files</strong></p>
<p><strong>6.23</strong> Comptar el número de factures de cada venedor a cada client.</p>
<p><img alt="ref17" src="exercicis_de_tot_el_tema_amb_els_resultats.018.png" /></p>
<p>Un total de <strong>96 files</strong></p>
<p>D'aquestes 96 files, relativament poque tenen un valor diferent de 1 en el número de factures: la fila 29 (455, 30, 2) o la fila 34 (5, 342, 3)</p>
<p><strong>6.24</strong> Comptar el número de factures de cada trimestre. Per a poder traure el trimestre i agrupar per ell (ens val el número de trimestre, que va del 1 al 4), podem utilitzar la funció <strong>TO_CHAR(data,'Q')</strong>.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p>No apareix ordenat, i vol dir que en el trimestre 2 hi ha 25 factures, en el trimestre 4 hi ha 25, en el trimestre 3 hi ha 33 i en el trimestre 1 hi ha 22</p>
<p><strong>6.25</strong> Calcular quantes vegades s'ha venut un article, la suma d'unitats venudes, la quantitat màxima i la quantitat mínima.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p>Un total de <strong>399 files</strong></p>
<p><strong>6.26</strong> Comptar el número d'articles de cada categoria i el preu mitjà.</p>
<p><img alt="ref18" src="exercicis_de_tot_el_tema_amb_els_resultats.019.png" /></p>
<p><strong>6.27</strong> Calcular el total de cada factura, sense aplicar descomptes ni IVA. Només ens farà falta la taula <strong>LINIES_FAC</strong>, i consistirà en agrupar per cada <strong>num_f</strong> per a calcular la suma del <strong>preu</strong> multiplicat per la <strong>quantitat</strong>.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p>Un total de <strong>105 files</strong></p>
<p><strong>6.28</strong> Calcular la mitjana de quantitats demanades d'aquells articles que s'han demanat més de dues vegades. Observeu que la taula que ens fa falta és LINIA_FAC, i que la condició (en el HAVING) és sobre el número de vegades que entra l'article en una linia de factura, però el resultat que s'ha de mostrar és la mitjana de la quantitat.</p>
<p><img alt="ref19" src="exercicis_de_tot_el_tema_amb_els_resultats.020.png" /></p>
<p><strong>6.29</strong> Traure els pobles que tenen entre 3 i 7 clients. Traure només el codi del poble i aquest número</p>
<p><img alt="ref20" src="exercicis_de_tot_el_tema_amb_els_resultats.021.png" /></p>
<p><strong>6.30</strong> Traure les categories que tenen més d'un article "car" (de més de 100 €). Observeu que també ens eixirà la categoria NULL, és a dir, apareixerà com una categoria aquells articles que no estan catalogats.</p>
<p><img alt="ref21" src="exercicis_de_tot_el_tema_amb_els_resultats.022.png" /></p>
<p><strong>6.31</strong> Traure els clients que tenen més d'una factura, amb el número de factures.</p>
<p><img alt="ref22" src="exercicis_de_tot_el_tema_amb_els_resultats.023.png" /></p>
<p>Un total de <strong>33 files</strong></p>
<p><strong>6.32</strong> Modificar l'anterior per a traure els clients que tenen més d'una factura en el primer trimestre.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.33</strong> Calcular el total de cada factura d'aquelles factures que tenen 10 o més línies de factura, sense aplicar descomptes ni IVA (com la consulta <strong>6.26</strong>), i també aplicant el descompte que consta en la línia de factura (no el descompte de tota la factura). Tindrem el problema que el valor NULL és especial, i en operar amb qualsevol altre valor donarà NULL. En aquest cas clarament l'hem de considerar com un descompte 0. Podeu utilitzar una funció que substitueix els valors nuls trobats en el primer paràmetre, pel segon paràmetre d'aquesta manera: <strong>COALESCE(dte,0)</strong></p>
<p><img alt="ref23" src="exercicis_de_tot_el_tema_amb_els_resultats.024.png" /></p>
<p><strong>6.34</strong> Traure tots els clients ordenats per codi de població, i dins d'aquestos per codi postal.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p>Un total de <strong>49 files</strong></p>
<p><strong>6.35</strong> Traure tots els articles ordenats per la categoria, dins d'aquest pel stock, i dins d'aquest per preu (de forma descendent)</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p>Un total de <strong>812 files</strong></p>
<p><strong>6.36</strong> Traure els resultats de la consulta <strong>6.33</strong> ordenats pel total de la factura quan ja s'ha aplicat el descompte, de forma descendent.</p>
<p><img alt="ref24" src="exercicis_de_tot_el_tema_amb_els_resultats.025.png" /></p>
<p><strong>6.37</strong> Traure tots els articles ordenats per la diferència entre el stock i el stock mínim de forma descendent. Com que en moltes ocasions el stock o el stock mínim és nul, hem de considerar en aquestos casos com 0. Per tant hem de tornar a utilitzar la funció <strong>COALESCE(stock,0)</strong> (i també per al stock mínim).</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p>Un total de <strong>812 files</strong></p>
<p><strong>6.38</strong> Traure els codis de venedor amb el número de factures venudes en el segon semestre de 2015, ordenades per aquest número de forma descendent</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.39</strong> Traure els venedors que han venut alguna cosa el mes de gener de 2015.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.40</strong> Traure els diferents tipus d'IVA que s'han aplicat a les factures de cada venedor, també durant el mes de gener de 2015</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.41</strong> Traure els diferents caps de venedors (eviteu que aparega el valor nul)</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.42</strong> Traure els diferents descomptes que s'han aplicat als articles, el codi dels quals comença per <strong>SAT</strong>. Traure tant el codi d'article com el descompte.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.43</strong> Comptar en quantes poblacions tenim clients</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.44</strong> Traure tota la informació dels dos articles més cars.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.45</strong> Traure el codi de les tres ciutats amb més clients</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.46</strong> Traure el venedor que ha venut menys factures</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><strong>6.47</strong> Traure les tres factures més cares (sense comptar els descomptes)</p>
<p><img alt="ref25" src="exercicis_de_tot_el_tema_amb_els_resultats.026.png" /></p>
<p><strong>6.48</strong> Modificar l'anterior per a traure totes les factures, excepte les 3 més cares.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p>Un total de <strong>102 files</strong></p>
<p><strong>6.49</strong> Crear una taula anomenada <strong>ARTICLE_999x</strong>, on 999 han de ser les 3 últimes xifres del DNI, i x la lletra del teu NIF, que siga una còpia de la taula ARTICLE, però substituint els valors nuls de <strong>stock</strong> i <strong>stock_min</strong> per zeros.</p>
<p>El resultat ha de ser la creació de la taula. Si consulteu el seu contingut ha de ser el següent:</p>
<p><img alt="ref26" src="exercicis_de_tot_el_tema_amb_els_resultats.027.png" /></p>
<p>Untotal de <strong>812 files</strong></p>
<p><strong>6.50</strong> Utilitzar la taula anterior per a traure el stock màxim, el mínim i la mitjana de stocks. Observeu que si utilitzàrem la taula ARTICLE, els resultats no serien els mateixos (excepte el màxim), sobretot la mitjana, ja que els valors nuls no entrarien en els càlculs d'aquesta mitjana.</p>
<p><img alt="ref4" src="exercicis_de_tot_el_tema_amb_els_resultats.005.png" /></p>
<p><a href="../19_ordre_amb_qu_sexecuta_una_sentncia_sql/">« Anterior</a></p>
<p>Llicenciat sota la <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Llicència Creative Commons Reconeixement NoComercial CompartirIgual 3.0</a>
<strong>Created with an evaluation copy of Aspose.Words. To discover the full versions of our APIs please visit: https://products.aspose.com/words/</strong></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.path", "navigation.indexes", "toc.integrate", "search.highlight", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>